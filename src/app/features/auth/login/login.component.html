<!-- src/app/features/auth/login/login.component.html -->

<!-- ✅ Toast global -->
<p-toast position="top-center" />

<div class="login-card shadow-2 border-round-2xl p-6 ">

    <div class="text-center mb-6">
        <div
            class="w-5rem h-5rem bg-primary border-round-2xl flex align-items-center justify-content-center mx-auto mb-4 shadow-2">
            <i class="pi pi-lock text-white text-4xl"></i>
        </div>
        <h1 class="text-3xl font-bold text-900 mb-2">2RS Contabilidade</h1>
        <p class="text-600 line-height-3">
            Contabilidade com comunicação inteligente, facilidade e segurança.
        </p>
    </div>
    <form [formGroup]="loginForm" (ngSubmit)="onSubmit()" class="login-form">
        <!-- Document (CPF/CNPJ) -->
        <div class="field">
            <p-inputGroup>
                <p-inputGroupAddon>
                    <i class="pi pi-user text-primary  "></i>
                </p-inputGroupAddon>
                <p-floatLabel variant="on">
                    <input pInputText type="text" id="document" formControlName="document" inputmode="numeric"
                        class="w-full" [attr.invalid]="isInvalid('document') ? '' : null" [disabled]="isSubmitting" />
                    <label for="document">CPF ou CNPJ *</label>
                </p-floatLabel>
                <p-inputGroupAddon *ngIf="isSubmitting">
                    <p-progressSpinner [animationDuration]="'0.5s'" ariaLabel="loading" strokeWidth="5"
                        fill="transparent" [style]="{ width: '100%', height: '100%' }"></p-progressSpinner>
                </p-inputGroupAddon>
            </p-inputGroup>


            @if (isInvalid('document')) {
            @if (loginForm.get('document')?.hasError('required')) {
            <p-message severity="error" variant="simple" size="small">CPF ou CNPJ é obrigatório</p-message>
            }
            @if (loginForm.get('document')?.hasError('cpfCnpj')) {
            <p-message severity="error" size="small">CPF ou CNPJ inválido.</p-message>
            }
            }
        </div>

        <!-- Password -->
        <div class="field">
            <p-inputGroup>
                <p-inputGroupAddon>
                    <i class="pi pi-lock text-primary"></i>
                </p-inputGroupAddon>
                <p-floatLabel variant="on">
                    <input pInputText type="password" id="password" formControlName="password" class="w-full"
                        [attr.invalid]="isInvalid('password') ? '' : null" [disabled]="isSubmitting" />
                    <label for="password">Senha *</label>
                </p-floatLabel>
                <p-inputGroupAddon *ngIf="isSubmitting">
                    <p-progressSpinner [animationDuration]="'0.5s'" ariaLabel="loading" strokeWidth="5"
                        fill="transparent" [style]="{ width: '100%', height: '100%' }"></p-progressSpinner>
                </p-inputGroupAddon>
            </p-inputGroup>

            @if (isInvalid('password')) {
            <p-message severity="error" size="small" variant="simple" text="Senha é obrigatória."></p-message>
            }
        </div>

        <!-- Sign In Button -->
        <button pButton severity="success" type="submit" class="sign-in-button w-full" [loading]="isSubmitting"
            [disabled]="loginForm.invalid || isSubmitting">
            <span pButtonLabel>Entrar</span>
        </button>
    </form>
    <!-- Linha divisória -->
    <hr class="my-4 w-full border-top-1 surface-border" />

    <!-- Link para WhatsApp -->
    <div class="text-center mt-2">
        <a href="https://wa.me/5585999999999?text=Olá! Preciso de ajuda com acesso ou recuperação de senha no sistema 2RS Contabilidade."
            target="_blank" rel="noopener noreferrer" class="text-primary font-medium hover:underline transition-all">
            Solicitar acesso / Esqueci minha senha
        </a>
    </div>
</div>